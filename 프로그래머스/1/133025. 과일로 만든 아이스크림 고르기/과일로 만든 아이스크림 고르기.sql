SELECT FLAVOR
FROM FIRST_HALF F
WHERE F.FLAVOR IN (
    SELECT FLAVOR
    FROM ICECREAM_INFO I
    WHERE I.INGREDIENT_TYPE = 'fruit_based')
AND F.TOTAL_ORDER > 3000